SELECT category,SUM(CASE WHEN age_group = '0-9' THEN value ELSE 0 END) AS '0-9',SUM(CASE WHEN age_group = '10-19' THEN value ELSE 0 END) AS '10-19', SUM(CASE WHEN age_group = '20-29' THEN value ELSE 0 END) AS '20-29', SUM(CASE WHEN age_group = '30-39' THEN value ELSE 0 END) AS '30-39',SUM(CASE WHEN age_group = '40-49' THEN value ELSE 0 END) AS '40-49', SUM(CASE WHEN age_group = '50-59' THEN value ELSE 0 END) AS '50-59', SUM(CASE WHEN age_group = '60-69' THEN value ELSE 0 END) AS '60-69', SUM(CASE WHEN age_group = '70+' THEN value ELSE 0 END) AS '70+' FROM vw_art_cascade WHERE (gender = '$gender' OR '$gender' = '') AND (age_group = '$age_group' OR '$age_group' = '') AND (year = COALESCE(NULLIF('$year', ''), '2021')) GROUP BY category ORDER BY CASE WHEN category = 'New Cases' THEN 1 WHEN category = 'Initiated on ART' THEN 2 WHEN category = 'Suppressed' THEN 3 WHEN category = 'Not Suppressed' THEN 4 END;